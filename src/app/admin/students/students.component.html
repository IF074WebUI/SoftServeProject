<h1>{{MAIN_HEADER}}</h1>

<dtester-search (searchCriteria)="searchStudent($event)"></dtester-search>

<dtester-items-per-page [numberOfRecords]="count" (recordsPerPageChanged)="changeCountPerPage($event)"></dtester-items-per-page>

<dtester-entities-table [entities]="students"
                        [headers]="headers"
                        [page]="page"
                        [itemsPerPage]="countPerPage"
                        (editEntity)="selectedStudentForEdit($event)"
                        (deleteEntity)="selectedStudentForDel($event)"
                        [ignoreProperties]="ignoreProperties"
                        [displayPropertiesOrder]="displayProperties">
</dtester-entities-table>

<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalAdd" data-whatever="@mdo">{{MODAL_ADD}}</button>

<div class="text-center">
  <dtester-pagination [countRecords]="count"
                      [recordsPerPage]="countPerPage"
                      [currentPage]="page"
                      (pageChanged)="changePage($event)">
  </dtester-pagination>
</div>

<div [ngClass]="{'modal': true, 'fade': true, 'show': showModal}" id="modalAdd" tabindex="-1"
     role="dialog" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <form #addForm="ngForm" [formGroup]="studentForm" method="post">
        <fieldset>
          <legend>{{MODAL_ADD}}</legend>
          <div class="form-group">
            <label class="form-control-label" for="groupId">Група:</label>
            <select formControlName="group_id" id="groupId" class="form-control">
              <option *ngFor="let group of groups" [ngValue]="group.group_id">{{group.group_name}}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="name">{{MODAL_NAME}}</label>
            <input formControlName="student_name" type="text" class="form-control" id="name">
          </div>
          <div class="invalid" *ngIf="studentForm.controls['student_name'].hasError('required') && studentForm.controls['student_name'].touched">
            {{MODAL_REQUIRED}}
          </div>
          <div class="form-group">
            <label for="surname">{{MODAL_SURNAME}}</label>
            <input formControlName="student_surname" type="text" class="form-control" id="surname">
          </div>
          <div class="invalid" *ngIf="studentForm.controls['student_surname'].hasError('required') && studentForm.controls['student_surname'].touched">
            {{MODAL_REQUIRED}}
          </div>
          <div class="form-group">
            <label for="f_name">{{MODAL_F_NAME}}</label>
            <input formControlName="student_fname" type="text" class="form-control" id="f_name">
          </div>
          <div class="invalid" *ngIf="studentForm.controls['student_fname'].hasError('required') && studentForm.controls['student_fname'].touched">
            {{MODAL_REQUIRED}}
          </div>
          <button class="btn btn-success my-button" type="submit" (click)="addStudent(addForm)"
                  data-dismiss="modal" [disabled]="!studentForm.valid">{{MODAL_ADD_ACTION}}</button>
          <button class="btn btn-secondary my-button" type="button" data-dismiss="modal" (click)="studentForm.reset()">{{MODAL_CANSEL}}</button>
        </fieldset>
      </form>
    </div>
  </div>
</div>

<div [ngClass]="{'modal': true, 'fade': true, 'show': showModal}" id="modalDel" tabindex="-1"
     role="dialog" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <form #delForm="ngForm">
        <fieldset>
          <legend class="del-legend">{{MODAL_DEL_HEADER}}</legend>
          <h2>{{MODAL_DEL_BODY}}</h2>
          <button (click)="deleteStudent()" type="submit" class="btn btn-danger my-button" data-dismiss="modal">{{MODAL_DEL}}</button>
          <button type="button" class="btn btn-secondary my-button" data-dismiss="modal">{{MODAL_CANSEL}}</button>
        </fieldset>
      </form>
    </div>
  </div>
</div>

<div [ngClass]="{'modal': true, 'fade': true, 'show': showModal}" id="modalEdit" tabindex="-1"
     role="dialog" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <form #editForm="ngForm" [formGroup]="studentEditForm" method="post">
        <fieldset>
          <legend class="edit-legend">{{MODAL_EDIR_HEADER}}</legend>
          <div class="form-group">
            <label class="form-control-label" for="groupEditId">{{MODAL_GROUP_NAME}}</label>
            <select formControlName="group_id" id="groupEditId" class="form-control">
              <option *ngFor="let group of groups" [ngValue]="group.group_id">{{group.group_name}}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="editName">{{MODAL_NAME}}</label>
            <input formControlName="student_name" type="text" class="form-control" id="editName">
          </div>
          <div class="invalid" *ngIf="studentForm.controls['student_name'].hasError('required') && studentForm.controls['student_name'].touched">
            {{MODAL_REQUIRED}}
          </div>
          <div class="form-group">
            <label for="editSurname">{{MODAL_SURNAME}}</label>
            <input formControlName="student_surname" type="text" class="form-control" id="editSurname">
          </div>
          <div class="invalid" *ngIf="studentForm.controls['student_surname'].hasError('required') && studentForm.controls['student_surname'].touched">
            {{MODAL_REQUIRED}}
          </div>
          <div class="form-group">
            <label for="editF_name">{{MODAL_F_NAME}}</label>
            <input formControlName="student_fname" type="text" class="form-control" id="editF_name">
          </div>
          <div class="invalid" *ngIf="studentForm.controls['student_fname'].hasError('required') && studentForm.controls['student_fname'].touched">
            {{MODAL_REQUIRED}}
          </div>
          <button class="btn btn-success my-button" type="submit" (click)="editStudent(editForm)"
                  data-dismiss="modal">{{MODAL_EDIT}}</button>
          <button class="btn btn-secondary my-button" type="button" data-dismiss="modal">{{MODAL_CANSEL}}</button>
        </fieldset>
      </form>
    </div>
  </div>
</div>

